<h2>Encumbrance Report Request</h2>
<%= form_for @encumbrance_report, multipart: true, class: 'form-group' do |f| %>
<% if @encumbrance_report.errors.any? %>
<div id="error_explanation">
  <ul>
    <% @encumbrance_report.errors.full_messages.each do |msg| %>
    <li><%= msg %></li>
    <% end %>
  </ul>
</div>
<% end %>
<div>
  <div class='form-group row'>
    <%= f.label :email, 'Email for notification when the report is ready:', class: 'col-sm-5 form-control-label' %>
    <div class='col-sm-10'>
      <%= f.text_field 'email', class: 'form-control' %>
    </div>
  </div>
  <div class='form-group row'>
    <%= f.label :fund_select, 'Select funds for report by:', class: 'col-sm-5 form-control-label'%>
    <div class='col-sm-10'>
      <p><%= f.radio_button :fund_select, 'fund_name_id', {} %> Fund ID or name</p>
      <p><%= f.radio_button :fund_select, 'fund_begins_with', {} %> Fund ID begins with</p>
    </div>
  </div>
  <div class='form-group row'>
    <%= f.label :fund_acct, 'Select one or more funds (click on header to sort):', class: 'col-sm-5 form-control-label'%>
    <div class='table-container col-sm-10 pad'>
      <table class='table table-striped'>
        <thead>
          <tr>
            <th class='col-xs-1'>Select fund for report</th>
            <th class='col-xs-1'>Fund ID</th>
            <th class='col-xs-1'>Name</th>
            <th class='col-xs-1'>Old fund ID</th>
            <th class='col-xs-1'>Minimum pay date</th>
            <th class='col-xs-1'>Maximum pay date</th>
          </tr>
        </thead>
        <tbody>
          <% ExpendituresFunds.fund_id.each do |d| %>
          <% if d.fund_name_key.present? %>
          <tr>
            <td><%= f.check_box :fund_acct, {multiple: true, class: 'form-control'}, d.fund_id, false %></td>
            <td><%= d.fund_id %></td>
            <td><%= d.fund_name_key %></td>
            <td><%= d.old_fund_id %></td>
            <td><%= d.min_pay_date.try(:strftime, '%Y-%m-%d') %></td>
            <td><%= d.max_pay_date.try(:strftime, '%Y-%m-%d') %></td>
          </tr>
          <% end %>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class='col-sm-10'>
      <%= f.select :fund_acct, options_for_select(ExpendituresFunds.fund_begins_with.map{|e| [e.fund_id]}), {}, {class: 'form-control'} %>
    </div>
  </div>
  <div class='form-group row'>
    <%= f.label :funding_paid, 'Show funds with payments:', class: 'col-sm-3 form-control-label' %>
    <div class='col-sm-10'>
      <%= f.radio_button :funding_paid, 'All records' %> All records<br />
      <%= f.radio_button :funding_paid, '$0 paid' %> $0 paid<br />
      <%= f.radio_button :funding_paid, 'More than $0 paid' %> More than $0 paid<br />
    </div>
  </div>
  <div class='form-group row'>
    <%= f.label :fundcyc_cycle, 'Fiscal Cycle:', class: 'col-sm-3 form-control-label' %>
    <div class='col-sm-10'>
      <%= f.select :fundcyc_cycle, options_for_select(EncumbranceReport.fundcyc_cycle.map{ |b| [ b ] }), {}, {class: 'form-control'} %>
    </div>
  </div>
  <div><%= f.submit 'Submit request', class: 'btn' %></div><br/>
</div>
<% end %>
<div class="btn-group">
  <%= main_menu_button %>
</div>
